/*! For license information please see d07c02c4.dfb250ca.js.LICENSE.txt */
"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3982],{7428:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>x,frontMatter:()=>d,metadata:()=>l,toc:()=>h});var i=s(5893),r=s(1151),o=s(9965);const d={layout:"docs",title:"The System Runner"},c="The Runner",l={unversionedId:"features/runner",id:"features/runner",title:"The System Runner",description:"The runner is the core feature in DOM Cloud. It let's you to perform automatic configuration all by convenience of a single script. It's also a CI (Continous Integration) tool that perform some tasks inside your website.",source:"@site/docs/features/runner.mdx",sourceDirName:"features",slug:"/features/runner",permalink:"/docs/features/runner",draft:!1,unlisted:!1,editUrl:"https://github.com/domcloud/domcloud-co/tree/master/docs/features/runner.mdx",tags:[],version:"current",frontMatter:{layout:"docs",title:"The System Runner"},sidebar:"tutorialSidebar",previous:{title:"NGINX and App Daemon",permalink:"/docs/features/nginx"},next:{title:"Linux Utilities",permalink:"/docs/features/service"}},t={},h=[{value:"<code>source</code>",id:"source",level:2},{value:"<code>url</code>",id:"url",level:3},{value:"<code>type</code>",id:"type",level:3},{value:"<code>directory</code> (<code>type: extract</code> only)",id:"directory-type-extract-only",level:3},{value:"<code>branch</code> (<code>type: clone</code> only)",id:"branch-type-clone-only",level:3},{value:"<code>shallow</code> (<code>type: clone</code> only)",id:"shallow-type-clone-only",level:3},{value:"<code>submodules</code> (<code>type: clone</code> only)",id:"submodules-type-clone-only",level:3},{value:"<code>features</code>",id:"features",level:2},{value:"<code>mysql</code>",id:"mysql",level:3},{value:"<code>postgresql</code>",id:"postgresql",level:3},{value:"<code>dns</code>",id:"dns",level:3},{value:"<code>firewall</code>",id:"firewall",level:3},{value:"<code>ssl</code>",id:"ssl",level:3},{value:"<code>root</code>",id:"root",level:3},{value:"<code>php</code>",id:"php",level:3},{value:"<code>node</code>",id:"node",level:3},{value:"<code>python</code>",id:"python",level:3},{value:"<code>ruby</code>",id:"ruby",level:3},{value:"<code>deno</code>",id:"deno",level:3},{value:"<code>go</code>",id:"go",level:3},{value:"<code>rust</code>",id:"rust",level:3},{value:"<code>nginx</code>",id:"nginx",level:2},{value:"<code>ssl</code>",id:"ssl-1",level:3},{value:"<code>fastcgi</code>",id:"fastcgi",level:3},{value:"<code>error_pages</code>",id:"error_pages",level:3},{value:"<code>passenger</code>",id:"passenger",level:2},{value:"<code>locations</code>",id:"locations",level:2},{value:"<code>commands</code>",id:"commands",level:2},{value:"Builtin envar for commands",id:"builtin-envar-for-commands",level:4},{value:"Builtin Git Credentials",id:"builtin-git-credentials",level:4},{value:"Time limit",id:"time-limit",level:4},{value:"<code>subdomains</code> and <code>subdomain</code>",id:"subdomains-and-subdomain",level:2}];function a(e){const n=Object.assign({h1:"h1",p:"p",code:"code",a:"a",pre:"pre",h2:"h2",blockquote:"blockquote",strong:"strong",h3:"h3",hr:"hr",ul:"ul",li:"li",admonition:"admonition",h4:"h4"},(0,r.ah)(),e.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"the-runner",children:"The Runner"}),"\n",(0,i.jsx)(n.p,{children:"The runner is the core feature in DOM Cloud. It let's you to perform automatic configuration all by convenience of a single script. It's also a CI (Continous Integration) tool that perform some tasks inside your website."}),"\n",(0,i.jsxs)(n.p,{children:["The system runner is accessible through ",(0,i.jsx)(n.code,{children:"Deploy"})," tab in the website menu."]}),"\n",(0,i.jsx)(o.Z,{sources:{dark:"/assets/ss/new-progress-b.png",light:"/assets/ss/new-progress-w.png"},alt:"",className:"img-fluid border rounded-3 shadow--md mb-4",width:"700",height:"500",loading:"lazy"}),"\n",(0,i.jsxs)(n.p,{children:["For common script deployments, there's existing recipes from ",(0,i.jsx)(n.a,{href:"/docs/deployment/",children:"the deployment page"})," or ",(0,i.jsx)(n.a,{href:"https://github.com/domcloud/recipes",children:"recipe repository"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["We make it as simple as possible to understand. We also make our runner script ",(0,i.jsx)(n.a,{href:"https://github.com/domcloud/bridge",children:"open sourced"})," so you take a better view of how it works if you want that."]}),"\n",(0,i.jsx)(n.p,{children:"The script runner is in YAML format. For example to create a new WordPress instance:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'source:\n  url: https://wordpress.org/latest.zip\n  directory: wordpress\nfeatures: [mysql, ssl]\nnginx:\n  ssl: enforce\n  fastcgi: on\n  locations:\n  - match: /\n    try_files: $uri $uri/ /index.php$is_args$args\ncommands:\n- cp wp-config-sample.php wp-config.php\n- sed -i "s/database_name_here/${DATABASE}/g" wp-config.php\n- sed -i "s/username_here/${USERNAME}/g" wp-config.php\n- sed -i "s/password_here/${PASSWORD}/g" wp-config.php\n- sed -i "s/utf8/utf8mb4/g" wp-config.php\n'})}),"\n",(0,i.jsxs)(n.p,{children:["With a quick look, you can tell that it will download ",(0,i.jsx)(n.code,{children:"https://wordpress.org/latest.zip"})," extracting and moving it out of ",(0,i.jsx)(n.code,{children:"wordpress"})," directory, then creating a mysql database and signing SSL certificate, also configuring the correct NGINX record for WordPress and perform quick ",(0,i.jsx)(n.code,{children:"sed"})," operations to inject database credentials directly to the config files."]}),"\n",(0,i.jsx)(n.p,{children:"Here's what you can configure within the system runner:"}),"\n",(0,i.jsx)(n.h2,{id:"source",children:(0,i.jsx)(n.code,{children:"source"})}),"\n",(0,i.jsxs)(n.p,{children:["Type: ",(0,i.jsx)(n.code,{children:"string"})," or ",(0,i.jsx)(n.code,{children:"object"}),". If it a string, it will be the ",(0,i.jsx)(n.code,{children:"url"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["If this value is set, it will download contents inside the host. The content can be either a ZIP file or a Git repository (to perform clone), or ",(0,i.jsx)(n.code,{children:"clear"})," to simply clears the content."]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["CAUTION: This option will always ",(0,i.jsx)(n.strong,{children:"overwrite"})," all contents inside the host. Use with caution."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"url",children:(0,i.jsx)(n.code,{children:"url"})}),"\n",(0,i.jsx)(n.p,{children:"The zip (or clone) URL to download. Required."}),"\n",(0,i.jsx)(n.h3,{id:"type",children:(0,i.jsx)(n.code,{children:"type"})}),"\n",(0,i.jsxs)(n.p,{children:["To ",(0,i.jsx)(n.code,{children:"extract"})," a ZIP file or ",(0,i.jsx)(n.code,{children:"clone"})," a repo. If omitted, it autodetects whether it is a ",(0,i.jsx)(n.code,{children:"github.com"})," or ",(0,i.jsx)(n.code,{children:"gitlab.com"})," URL and perform ",(0,i.jsx)(n.code,{children:"clone"})," instead of ",(0,i.jsx)(n.code,{children:"extract"}),"."]}),"\n",(0,i.jsxs)(n.h3,{id:"directory-type-extract-only",children:[(0,i.jsx)(n.code,{children:"directory"})," (",(0,i.jsx)(n.code,{children:"type: extract"})," only)"]}),"\n",(0,i.jsxs)(n.p,{children:["Specify the folder name to move out of ZIP file after extraction. This also can be specified from ",(0,i.jsx)(n.code,{children:"url"}),"'s hash. If omitted, no move operation performed."]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["For legacy reason, a ",(0,i.jsx)(n.code,{children:"directory"})," in root config will works too, it will be converted as ",(0,i.jsx)(n.code,{children:"source.directory"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"branch-type-clone-only",children:[(0,i.jsx)(n.code,{children:"branch"})," (",(0,i.jsx)(n.code,{children:"type: clone"})," only)"]}),"\n",(0,i.jsxs)(n.p,{children:["Specify the clone branch to get checked out. This also can be specified from directory or ",(0,i.jsx)(n.code,{children:"url"}),"'s hash. If omitted, the default branch is checked out."]}),"\n",(0,i.jsxs)(n.h3,{id:"shallow-type-clone-only",children:[(0,i.jsx)(n.code,{children:"shallow"})," (",(0,i.jsx)(n.code,{children:"type: clone"})," only)"]}),"\n",(0,i.jsxs)(n.p,{children:["Do shallow clone? Default to ",(0,i.jsx)(n.code,{children:"true"}),". It is recommended to leave it that way to keep ",(0,i.jsx)(n.code,{children:".git"})," internal size low."]}),"\n",(0,i.jsxs)(n.h3,{id:"submodules-type-clone-only",children:[(0,i.jsx)(n.code,{children:"submodules"})," (",(0,i.jsx)(n.code,{children:"type: clone"})," only)"]}),"\n",(0,i.jsxs)(n.p,{children:["Do Recursive clone of submodules? Default to ",(0,i.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"features",children:(0,i.jsx)(n.code,{children:"features"})}),"\n",(0,i.jsxs)(n.p,{children:["Type: Array of ",(0,i.jsx)(n.code,{children:"string"})," or ",(0,i.jsx)(n.code,{children:"object"}),". If one item is a string, it will be converted to object (.e.g. ",(0,i.jsx)(n.code,{children:"mysql on"})," become ",(0,i.jsx)(n.code,{children:"{ mysql: on }"}),")."]}),"\n",(0,i.jsx)(n.p,{children:"This configures all features available for the host in DOM Cloud."}),"\n",(0,i.jsx)(n.h3,{id:"mysql",children:(0,i.jsx)(n.code,{children:"mysql"})}),"\n",(0,i.jsx)(n.p,{children:"Configure MariaDB (MySQL) Database Server."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"mysql"})," or ",(0,i.jsx)(n.code,{children:"mysql on"})," Enable MariaDB and create default DB."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"mysql create <dbname>"})," Create a new database with ",(0,i.jsx)(n.code,{children:"<dbname>"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"mysql drop <dbname>"})," Drop a database with ",(0,i.jsx)(n.code,{children:"<dbname>"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"mysql off"}),". Disables ",(0,i.jsx)(n.code,{children:"mysql"})," feature. ",(0,i.jsx)(n.strong,{children:"Caution: Also drop all DB  permanently"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"postgresql",children:(0,i.jsx)(n.code,{children:"postgresql"})}),"\n",(0,i.jsx)(n.p,{children:"Configure PostgreSQL Database Server."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"postgresql"})," or ",(0,i.jsx)(n.code,{children:"postgresql on"})," Enable PostgreSQL and create default DB."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"postgresql create <dbname>"})," Create a new database with ",(0,i.jsx)(n.code,{children:"<dbname>"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"postgresql drop <dbname>"})," Drop a database with ",(0,i.jsx)(n.code,{children:"<dbname>"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"postgresql off"}),". Disables ",(0,i.jsx)(n.code,{children:"postgresql"})," feature. ",(0,i.jsx)(n.strong,{children:"Caution: Also drop all DB permanently"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"dns",children:(0,i.jsx)(n.code,{children:"dns"})}),"\n",(0,i.jsx)(n.p,{children:"Configure BIND DNS Server."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dns"})," or ",(0,i.jsx)(n.code,{children:"dns on"})," Enable DNS server."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dns add <type> <value>"})," Add a record."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dns rem <type> <value>"})," Deletes a record."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dns off"}),". Disables ",(0,i.jsx)(n.code,{children:"dns"})," feature. ",(0,i.jsx)(n.strong,{children:"Caution: Also clears all DNS records"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"You can add multiple records with lists. For example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"features:\n- dns:\n  - add a sub-a 1.2.3.4\n  - add aaaa sub-a 1.2.3.4\n  - add cname sub-b example.net.\n  - add cname sub-c example.net.\n"})}),"\n",(0,i.jsx)(n.p,{children:"DNS records for child server is handled automatically."}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsxs)(n.p,{children:["When applying CNAME, looks out for the trailing dot (",(0,i.jsx)(n.code,{children:"."}),") at the end of CNAME values."]}),(0,i.jsx)(n.p,{children:"It is required to specify the root domain, otherwise it will be appended with the parent domain."})]}),"\n",(0,i.jsx)(n.h3,{id:"firewall",children:(0,i.jsx)(n.code,{children:"firewall"})}),"\n",(0,i.jsx)(n.p,{children:"Configure Whitelist Firewall."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"firewall on"})," or ",(0,i.jsx)(n.code,{children:"firewall"})," Enable firewall."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"firewall off"})," Disable firewall."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Firewall is an additional protection to make sure the host won't send any outgoing request not defined ",(0,i.jsx)(n.a,{href:"https://github.com/domcloud/bridge/blob/main/src/whitelist/sites.conf",children:"in the whitelist"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["It's intended for use of hosts with ",(0,i.jsx)(n.a,{href:"https://github.com/domcloud/domcloud/issues/10",children:"low security measures"}),". It's recommended for any host who doesn't use any third-party API."]}),"\n",(0,i.jsx)(n.admonition,{type:"caution",children:(0,i.jsx)(n.p,{children:"Please note due to obvious PHP weakness in security, it's mandatory to turn on this feature for WordPress or any weakly protected PHP server."})}),"\n",(0,i.jsx)(n.h3,{id:"ssl",children:(0,i.jsx)(n.code,{children:"ssl"})}),"\n",(0,i.jsx)(n.p,{children:"Attempt to renew SSL certificate with Let's Encrypt."}),"\n",(0,i.jsx)(n.h3,{id:"root",children:(0,i.jsx)(n.code,{children:"root"})}),"\n",(0,i.jsxs)(n.p,{children:["Set directory root path. This also changes the ",(0,i.jsx)(n.code,{children:"root"})," directive in NGINX config."]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"Because of legacy reason, this is also available in root config."})}),"\n",(0,i.jsx)(n.h3,{id:"php",children:(0,i.jsx)(n.code,{children:"php"})}),"\n",(0,i.jsx)(n.p,{children:"Set PHP (FastCGI) version. Available options:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"php 7.4"})," (default)"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"php 8.0"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"php 8.1"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"php 8.2"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"php latest"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Remember that ",(0,i.jsx)(n.code,{children:"php 8.x"})," is an active release."]}),"\n",(0,i.jsxs)(n.p,{children:["This also sets the ",(0,i.jsx)(n.code,{children:"php"})," (and ",(0,i.jsx)(n.code,{children:"composer"}),") to the right version in CLI/SSH."]}),"\n",(0,i.jsxs)(n.p,{children:["PHP files that served through NginX are served with ",(0,i.jsx)(n.code,{children:"php-fpm"})," (FastCGI Process Manager)."]}),"\n",(0,i.jsx)(n.h3,{id:"node",children:(0,i.jsx)(n.code,{children:"node"})}),"\n",(0,i.jsx)(n.p,{children:"Install specific NodeJS version. Available options:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"node"})," or ",(0,i.jsx)(n.code,{children:"node lts"})]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"node latest"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"node beta"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"node x.y.z"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"node off"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"By default it's Node 16.x provided from system."}),"\n",(0,i.jsxs)(n.p,{children:["This also sets the ",(0,i.jsx)(n.code,{children:"node"})," (and ",(0,i.jsx)(n.code,{children:"npm"}),", ",(0,i.jsx)(n.code,{children:"yarn"}),", etc.) to the right version in CLI/SSH. This installation is powered by ",(0,i.jsx)(n.a,{href:"https://webinstall.dev/node",children:"webi"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"python",children:(0,i.jsx)(n.code,{children:"python"})}),"\n",(0,i.jsx)(n.p,{children:"Install specific Python version. Available options:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"python"})," or ",(0,i.jsx)(n.code,{children:"python latest"})]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"python x.y"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"python x.y.z"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"python off"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"By default it's Python 3.9 provided from system."}),"\n",(0,i.jsxs)(n.p,{children:["This also sets the ",(0,i.jsx)(n.code,{children:"python"})," (and ",(0,i.jsx)(n.code,{children:"pip"}),") to the right version in CLI/SSH. This installation is powered by ",(0,i.jsx)(n.a,{href:"https://github.com/pyenv/pyenv",children:"pyenv"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"ruby",children:(0,i.jsx)(n.code,{children:"ruby"})}),"\n",(0,i.jsx)(n.p,{children:"Install specific Ruby version. Available options:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ruby"})," or ",(0,i.jsx)(n.code,{children:"ruby latest"})]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"ruby x.y.z"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"ruby off"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["By default it's Ruby 3.0 provided from system. This installation is powered by ",(0,i.jsx)(n.a,{href:"https://rvm.io",children:"rvm"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"deno",children:(0,i.jsx)(n.code,{children:"deno"})}),"\n",(0,i.jsx)(n.p,{children:"Install specific Deno version. Available options:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"deno"})," or ",(0,i.jsx)(n.code,{children:"deno latest"})]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"deno beta"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"deno x.y.z"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"deno off"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"There's no default Deno version provided from system."}),"\n",(0,i.jsxs)(n.p,{children:["This installation is powered by ",(0,i.jsx)(n.a,{href:"https://webinstall.dev/deno",children:"webi"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"go",children:(0,i.jsx)(n.code,{children:"go"})}),"\n",(0,i.jsx)(n.p,{children:"Install specific Go version. Available options:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"go"})," or ",(0,i.jsx)(n.code,{children:"go latest"})]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"go x.y.z"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"go off"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"There's no default Go version provided from system."}),"\n",(0,i.jsxs)(n.p,{children:["This installation is powered by ",(0,i.jsx)(n.a,{href:"https://webinstall.dev/golang",children:"webi"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"rust",children:(0,i.jsx)(n.code,{children:"rust"})}),"\n",(0,i.jsx)(n.p,{children:"Install specific Rust version. Available options:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"rust"})," or ",(0,i.jsx)(n.code,{children:"rust latest"})]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"rust x.y.z"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"rust off"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"There's no default Rust version provided from system."}),"\n",(0,i.jsxs)(n.p,{children:["This installation is powered by ",(0,i.jsx)(n.a,{href:"https://rustup.rs",children:"rustup"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"nginx",children:(0,i.jsx)(n.code,{children:"nginx"})}),"\n",(0,i.jsxs)(n.p,{children:["Type: ",(0,i.jsx)(n.code,{children:"object"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"This is the NGINX configuration for a given host."}),"\n",(0,i.jsxs)(n.p,{children:["All configurations below are not preserved at each config update. It's recommended to use the ",(0,i.jsx)(n.code,{children:"NGINX"})," tab in the dashboard to reconfigure NGINX."]}),"\n",(0,i.jsx)(n.h3,{id:"ssl-1",children:(0,i.jsx)(n.code,{children:"ssl"})}),"\n",(0,i.jsxs)(n.p,{children:["HTTPS options: ",(0,i.jsx)(n.code,{children:"on"})," (default), ",(0,i.jsx)(n.code,{children:"always"})," (always redirect HTTP to HTTPS), ",(0,i.jsx)(n.code,{children:"off"})," (not recommended)."]}),"\n",(0,i.jsx)(n.h3,{id:"fastcgi",children:(0,i.jsx)(n.code,{children:"fastcgi"})}),"\n",(0,i.jsxs)(n.p,{children:["Whether to enable or not enable PHP file execution: ",(0,i.jsx)(n.code,{children:"on"})," or ",(0,i.jsx)(n.code,{children:"off"}),". If omitted, ",(0,i.jsx)(n.code,{children:"off"})," is the default."]}),"\n",(0,i.jsxs)(n.p,{children:["You can override PHP settings via the ",(0,i.jsx)(n.code,{children:".user.ini"})," file in the document root. Once changed it will not change immediately due to cache, but usually takes no more than 5 minutes."]}),"\n",(0,i.jsx)(n.h3,{id:"error_pages",children:(0,i.jsx)(n.code,{children:"error_pages"})}),"\n",(0,i.jsxs)(n.p,{children:["List of error pages command. It's particularly useful for static websites. Read on ",(0,i.jsx)(n.a,{href:"http://nginx.org/en/docs/http/ngx_http_core_module.html#error_page",children:"the NGINX docs"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"404 /404.html"}),": Show ",(0,i.jsx)(n.code,{children:"404"})," error page as ",(0,i.jsx)(n.code,{children:"404.html"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"404 =200 /200.html"}),": Assume ",(0,i.jsx)(n.code,{children:"404"})," error as 200 OK and show ",(0,i.jsx)(n.code,{children:"200.html"})," (SPA)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"500 502 503 504 /50x.html"}),": Show ",(0,i.jsx)(n.code,{children:"50x"})," error as ",(0,i.jsx)(n.code,{children:"50x.html"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"passenger",children:(0,i.jsx)(n.code,{children:"passenger"})}),"\n",(0,i.jsxs)(n.p,{children:["If you want to run Non-PHP apps, you need to setup with ",(0,i.jsx)(n.a,{href:"https://www.phusionpassenger.com/",children:"Passenger Phusion"}),". Passenger is an additional layer on top of NGINX to run any non-PHP apps."]}),"\n",(0,i.jsx)(n.p,{children:"To enable non-PHP apps, at minimum you need these configuration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"root: public_html/public\nnginx:\n  passenger:\n    enabled: on\n    app_start_command: node server.js --port=$PORT\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The configuration above will execute ",(0,i.jsx)(n.code,{children:"node server.js --port=$PORT"})," in the parent of root folder (in this case, ",(0,i.jsx)(n.code,{children:"~/public_html"}),"). Note that you always need to pass the ",(0,i.jsx)(n.code,{children:"$PORT"})," and use that as the port where your app is listening to. If your app accept port from environment instead you can use env like ",(0,i.jsx)(n.code,{children:"env PORT=$PORT node server.js"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["For custom environment values you can leverage ",(0,i.jsx)(n.code,{children:"app_env"})," and ",(0,i.jsx)(n.code,{children:"env_var_list"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["To restart a non-PHP apps you can execute ",(0,i.jsx)(n.code,{children:"passenger-config restart-app /"})," in CLI/SSH. You can also make it ",(0,i.jsx)(n.a,{href:"https://www.phusionpassenger.com/library/admin/apache/restart_app.html#restart-txt",children:"always restart"})," if you have to."]}),"\n",(0,i.jsx)(n.p,{children:"Available options:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://www.phusionpassenger.com/docs/references/config_reference/nginx/#passenger_enabled",children:(0,i.jsx)(n.code,{children:"enabled"})}),": ",(0,i.jsx)(n.code,{children:"on"})," or ",(0,i.jsx)(n.code,{children:"off"})," (default)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://www.phusionpassenger.com/docs/references/config_reference/nginx/#passenger_app_env",children:(0,i.jsx)(n.code,{children:"app_env"})}),": environment setup. Either ",(0,i.jsx)(n.code,{children:"production"})," (default) or ",(0,i.jsx)(n.code,{children:"development"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://www.phusionpassenger.com/docs/references/config_reference/nginx/#passenger_env_var",children:(0,i.jsx)(n.code,{children:"env_var_list"})}),": array of environment values in the format of ",(0,i.jsx)(n.code,{children:"KEY=VALUE"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://www.phusionpassenger.com/docs/references/config_reference/nginx/#passenger_app_start_command",children:(0,i.jsx)(n.code,{children:"app_start_command"})}),": ",(0,i.jsx)(n.a,{href:"https://www.phusionpassenger.com/docs/advanced_guides/gls/",children:"Passenger GLS"})," command to start the app with ",(0,i.jsx)(n.code,{children:"$PORT"})," as the port where your app is listening to."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://www.phusionpassenger.com/docs/references/config_reference/nginx/#passenger_friendly_error_pages",children:(0,i.jsx)(n.code,{children:"friendly_error_pages"})}),": ",(0,i.jsx)(n.code,{children:"on"})," (default) or ",(0,i.jsx)(n.code,{children:"off"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://www.phusionpassenger.com/docs/references/config_reference/nginx/#passenger_base_uri",children:(0,i.jsx)(n.code,{children:"base_uri"})}),": base URL for the app (default is ",(0,i.jsx)(n.code,{children:"/"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://www.phusionpassenger.com/docs/references/config_reference/nginx/#passenger_sticky_sessions",children:(0,i.jsx)(n.code,{children:"sticky_sessions"})}),": ",(0,i.jsx)(n.code,{children:"on"})," or ",(0,i.jsx)(n.code,{children:"off"})," (default). Enable this for websocket support."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://www.phusionpassenger.com/docs/references/config_reference/nginx/#passenger_document_root",children:(0,i.jsx)(n.code,{children:"document_root"})}),": path to public document root (default is ",(0,i.jsx)(n.code,{children:"root"}),"). This value is relative to the user ",(0,i.jsx)(n.code,{children:"$HOME"})," folder."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://www.phusionpassenger.com/docs/references/config_reference/nginx/#passenger_app_root",children:(0,i.jsx)(n.code,{children:"app_root"})}),": path to app root (default is parent of ",(0,i.jsx)(n.code,{children:"root"}),"). This value is relative to the user ",(0,i.jsx)(n.code,{children:"$HOME"})," folder."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"For non-GLS these options are available too:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"app_type"}),": Type of App"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"startup_file"}),": Startup filename"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ruby"}),": Ruby path"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"nodejs"}),": Nodejs path"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"python"}),": Python path"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"meteor_app_settings"}),": Meteor path"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://www.phusionpassenger.com/passenger6",children:"GLS (Generic Language Support)"})," is a cool concept where you can run any language or binaries within NGINX with the help of Passenger. It's recommended to use GLS instead of the non-GLS options."]})}),"\n",(0,i.jsx)(n.h2,{id:"locations",children:(0,i.jsx)(n.code,{children:"locations"})}),"\n",(0,i.jsx)(n.p,{children:"Array objects which one or more of:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"match"}),": Matching URL location (required)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"root"}),": Root path (relative to ",(0,i.jsx)(n.code,{children:"$HOME"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"alias"}),": Alias path (relative to ",(0,i.jsx)(n.code,{children:"$HOME"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"rewrite"}),": Rewrite URL directive"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"try_files"}),": Try files URL directive"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"return"}),": Return code directive"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"fastcgi"}),": (same as above)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"passenger"}),": (same as above)"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Please read ",(0,i.jsx)(n.a,{href:"http://nginx.org/en/docs/http/ngx_http_core_module.html#location",children:"NGINX Location directive"})," for more information."]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"proxy_pass"}),", although it's popular, we're not supporting it because it's not a good practice to use it in a shared servers. You must use ",(0,i.jsx)(n.code,{children:"passenger"})," instead."]})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"commands",children:(0,i.jsx)(n.code,{children:"commands"})}),"\n",(0,i.jsxs)(n.p,{children:["Type: array of ",(0,i.jsx)(n.code,{children:"string"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["List of SSH commands in sequence. The starting directory is always ",(0,i.jsx)(n.code,{children:"~/public_html"}),". If any exit code detected to be not zero, the execution chain stop."]}),"\n",(0,i.jsxs)(n.p,{children:["This is where all the things you usually put after the execution of ",(0,i.jsx)(n.code,{children:"source"}),". Things like installing depedencies, bundling frontend or injecting database credential."]}),"\n",(0,i.jsxs)(n.p,{children:["The list of commands is always executed after the ",(0,i.jsx)(n.code,{children:"source"})," and ",(0,i.jsx)(n.code,{children:"features"})," and before ",(0,i.jsx)(n.code,{children:"nginx"})," and ",(0,i.jsx)(n.code,{children:"root"})," list."]}),"\n",(0,i.jsx)(n.h4,{id:"builtin-envar-for-commands",children:"Builtin envar for commands"}),"\n",(0,i.jsx)(n.p,{children:"Aside with the usual SSH commands, it does have an additional envar to help with scripting:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"$USERNAME"}),": The username."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"$DATABASE"}),": The database name (usually ",(0,i.jsx)(n.code,{children:"${USERNAME}_db"})," but can be changed if new database name is supplied before)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"$PASSWORD"}),": The user login password."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"$DOMAIN"}),": The domain name."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"These envars also will be set:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"CI=true"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"CONTINUOUS_INTEGRATION=true"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"DEBIAN_FRONTEND=noninteractive"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"LANG=en_US.UTF-8 LC_ALL=en_US.UTF-8"})}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"builtin-git-credentials",children:"Builtin Git Credentials"}),"\n",(0,i.jsxs)(n.p,{children:["If you have logged in with GitHub with repo access, an envar ",(0,i.jsx)(n.code,{children:"$GITHUB_TOKEN"})," will be available for you to use. Together with Git Credentials API, it will grant the access to your private repos along with all ",(0,i.jsx)(n.code,{children:"git"})," commands run from the Runner."]}),"\n",(0,i.jsx)(n.p,{children:"This is useful for cloning or pulling private repos after a webhook is received, for example."}),"\n",(0,i.jsxs)(n.admonition,{type:"caution",children:[(0,i.jsxs)(n.p,{children:["This does have security implication and we have taken some security measures to prevent leaks. For example, since it's provided within envar, you ",(0,i.jsx)(n.code,{children:"git"})," commands will break if run within SSH. That's because its doesn't saved anywhere in the server."]}),(0,i.jsxs)(n.p,{children:["We doesn't prevent you, for example to run ",(0,i.jsx)(n.code,{children:"echo $GITHUB_TOKEN"})," in the ",(0,i.jsx)(n.code,{children:"commands"})," list and use it as the token used for SSH session. But we do recommend you to not do that."]})]}),"\n",(0,i.jsx)(n.h4,{id:"time-limit",children:"Time limit"}),"\n",(0,i.jsx)(n.p,{children:"The time limit for overall script in single run is 10 minutes. If it's exceeded, the execution chain will automatically stop."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"subdomains-and-subdomain",children:[(0,i.jsx)(n.code,{children:"subdomains"})," and ",(0,i.jsx)(n.code,{children:"subdomain"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"subdomains"})," is used to run specific commands for a given ",(0,i.jsx)(n.code,{children:"subdomain"})," name. It's an array of objects with ",(0,i.jsx)(n.code,{children:"subdomain"}),", some of the ",(0,i.jsx)(n.code,{children:"features"})," and ",(0,i.jsx)(n.code,{children:"commands"})," keys."]})]})}const x=function(e={}){const{wrapper:n}=Object.assign({},(0,r.ah)(),e.components);return n?(0,i.jsx)(n,Object.assign({},e,{children:(0,i.jsx)(a,e)})):a(e)}},5251:(e,n,s)=>{s(7418);var i=s(7294),r=60103;if(n.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var o=Symbol.for;r=o("react.element"),n.Fragment=o("react.fragment")}var d=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c=Object.prototype.hasOwnProperty,l={key:!0,ref:!0,__self:!0,__source:!0};function t(e,n,s){var i,o={},t=null,h=null;for(i in void 0!==s&&(t=""+s),void 0!==n.key&&(t=""+n.key),void 0!==n.ref&&(h=n.ref),n)c.call(n,i)&&!l.hasOwnProperty(i)&&(o[i]=n[i]);if(e&&e.defaultProps)for(i in n=e.defaultProps)void 0===o[i]&&(o[i]=n[i]);return{$$typeof:r,type:e,key:t,ref:h,props:o,_owner:d.current}}n.jsx=t,n.jsxs=t},5893:(e,n,s)=>{e.exports=s(5251)},1151:(e,n,s)=>{s.d(n,{Zo:()=>c,ah:()=>o});var i=s(7294);const r=i.createContext({});function o(e){const n=i.useContext(r);return i.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const d={};function c({components:e,children:n,disableParentContext:s}){let c;return c=s?"function"==typeof e?e({}):e||d:o(e),i.createElement(r.Provider,{value:c},n)}}}]);