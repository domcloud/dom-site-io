"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8811],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>m});var a=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function r(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var p=a.createContext({}),s=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=s(e.components);return a.createElement(p.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},c=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,l=e.originalType,p=e.parentName,u=r(e,["components","mdxType","originalType","parentName"]),c=s(t),m=i,h=c["".concat(p,".").concat(m)]||c[m]||d[m]||l;return t?a.createElement(h,o(o({ref:n},u),{},{components:t})):a.createElement(h,o({ref:n},u))}));function m(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var l=t.length,o=new Array(l);o[0]=c;var r={};for(var p in n)hasOwnProperty.call(n,p)&&(r[p]=n[p]);r.originalType=e,r.mdxType="string"==typeof e?e:i,o[1]=r;for(var s=2;s<l;s++)o[s]=t[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}c.displayName="MDXCreateElement"},5162:(e,n,t)=>{t.d(n,{Z:()=>o});var a=t(7294),i=t(6010);const l="tabItem_Ymn6";function o(e){let{children:n,hidden:t,className:o}=e;return a.createElement("div",{role:"tabpanel",className:(0,i.Z)(l,o),hidden:t},n)}},5488:(e,n,t)=>{t.d(n,{Z:()=>m});var a=t(7462),i=t(7294),l=t(6010),o=t(2389),r=t(7392),p=t(7094),s=t(2466);const u="tabList__CuJ",d="tabItem_LNqP";function c(e){var n,t;const{lazy:o,block:c,defaultValue:m,values:h,groupId:g,className:k}=e,f=i.Children.map(e.children,(e=>{if((0,i.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),b=null!=h?h:f.map((e=>{let{props:{value:n,label:t,attributes:a}}=e;return{value:n,label:t,attributes:a}})),v=(0,r.l)(b,((e,n)=>e.value===n.value));if(v.length>0)throw new Error('Docusaurus error: Duplicate values "'+v.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.');const N=null===m?m:null!=(n=null!=m?m:null==(t=f.find((e=>e.props.default)))?void 0:t.props.value)?n:f[0].props.value;if(null!==N&&!b.some((e=>e.value===N)))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+N+'" but none of its children has the corresponding value. Available values are: '+b.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");const{tabGroupChoices:y,setTabGroupChoices:P}=(0,p.U)(),[w,C]=(0,i.useState)(N),x=[],{blockElementScrollPositionUntilNextRender:_}=(0,s.o5)();if(null!=g){const e=y[g];null!=e&&e!==w&&b.some((n=>n.value===e))&&C(e)}const T=e=>{const n=e.currentTarget,t=x.indexOf(n),a=b[t].value;a!==w&&(_(n),C(a),null!=g&&P(g,String(a)))},H=e=>{var n;let t=null;switch(e.key){case"ArrowRight":{var a;const n=x.indexOf(e.currentTarget)+1;t=null!=(a=x[n])?a:x[0];break}case"ArrowLeft":{var i;const n=x.indexOf(e.currentTarget)-1;t=null!=(i=x[n])?i:x[x.length-1];break}}null==(n=t)||n.focus()};return i.createElement("div",{className:(0,l.Z)("tabs-container",u)},i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":c},k)},b.map((e=>{let{value:n,label:t,attributes:o}=e;return i.createElement("li",(0,a.Z)({role:"tab",tabIndex:w===n?0:-1,"aria-selected":w===n,key:n,ref:e=>x.push(e),onKeyDown:H,onFocus:T,onClick:T},o,{className:(0,l.Z)("tabs__item",d,null==o?void 0:o.className,{"tabs__item--active":w===n})}),null!=t?t:n)}))),o?(0,i.cloneElement)(f.filter((e=>e.props.value===w))[0],{className:"margin-top--md"}):i.createElement("div",{className:"margin-top--md"},f.map(((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==w})))))}function m(e){const n=(0,o.Z)();return i.createElement(c,(0,a.Z)({key:String(n)},e))}},6286:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>p,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var a=t(7462),i=(t(7294),t(3905)),l=t(5488),o=t(5162);const r={title:"PHP",sidebar_position:2},p="Deploying PHP Apps with DOM Cloud",s={unversionedId:"deploying/php",id:"deploying/php",title:"PHP",description:"PHP is a popular programming language for web development. PHP is served in production server using PHP-FPM.",source:"@site/docs/deploying/php.md",sourceDirName:"deploying",slug:"/deploying/php",permalink:"/docs/deploying/php",draft:!1,editUrl:"https://github.com/domcloud/domcloud-co/tree/master/docs/deploying/php.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"PHP",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Static Sites",permalink:"/docs/deploying/static-site"},next:{title:"Node.js",permalink:"/docs/deploying/node"}},u={},d=[{value:"Recipes",id:"recipes",level:2},{value:"NginX Setup",id:"nginx-setup",level:2},{value:"FastCGI on",id:"fastcgi-on",level:3},{value:"Rewrite root directory",id:"rewrite-root-directory",level:3},{value:"Reroute index.php",id:"reroute-indexphp",level:3},{value:"Multiple website in a domain",id:"multiple-website-in-a-domain",level:3},{value:"PHP environment setup",id:"php-environment-setup",level:2},{value:"Composer install",id:"composer-install",level:2},{value:"Clearing composer cache",id:"clearing-composer-cache",level:3},{value:"PHP INI configuration",id:"php-ini-configuration",level:2},{value:"PHP Error Logging",id:"php-error-logging",level:2},{value:"Restarting PHP",id:"restarting-php",level:2}],c={toc:d};function m(e){let{components:n,...t}=e;return(0,i.kt)("wrapper",(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"deploying-php-apps-with-dom-cloud"},"Deploying PHP Apps with DOM Cloud"),(0,i.kt)("p",null,"PHP is a popular programming language for web development. PHP is served in production server using PHP-FPM. "),(0,i.kt)("p",null,"Popular PHP recipes is ",(0,i.kt)("inlineCode",{parentName:"p"},"WordPress"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"CodeIgniter")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"Laravel"),". Please read our ",(0,i.kt)("a",{parentName:"p",href:"/docs/features/runner"},"Runner's Guide")," first if you haven't."),(0,i.kt)("h2",{id:"recipes"},"Recipes"),(0,i.kt)(l.Z,{mdxType:"Tabs"},(0,i.kt)(o.Z,{value:"simple",label:"Simple PHP",default:!0,mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'source: clear\nnginx:\n  fastcgi: on\ncommands:\n- echo "Hello, World!" > index.php\n')),(0,i.kt)("p",null,'A simple PHP that outputs "Hello, World!"')),(0,i.kt)(o.Z,{value:"wordpress",label:"WordPress",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'source: https://wordpress.org/latest.zip\ndirectory: wordpress\nfeatures:\n- mysql\nnginx:\n  fastcgi: on\n  locations:\n  - match: /\n    try_files: $uri $uri/ /index.php$is_args$args\n  - match: ~ /xmlrpc\\.php$\n    deny: all\ncommands:\n- cp wp-config-sample.php wp-config.php\n- sed -i "s/database_name_here/${DATABASE}/g" wp-config.php\n- sed -i "s/username_here/${USERNAME}/g" wp-config.php\n- sed -i "s/password_here/${PASSWORD}/g" wp-config.php\n- sed -i "s/utf8/utf8mb4/g" wp-config.php\n')),(0,i.kt)("p",null,"This downloads and extracts WordPress and setup the database.\nAlso blocks ",(0,i.kt)("inlineCode",{parentName:"p"},"/xmlrpc.php")," because it's a common DoS attack.")),(0,i.kt)(o.Z,{value:"codeigniter",label:"CodeIgniter",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'source: clear\nroot: public_html/public\nnginx:\n  fastcgi: on\n  locations:\n  - match: /\n    try_files: $uri $uri/ /index.php$is_args$args\ncommands:\n- composer create-project codeigniter4/appstarter .\n- cp env .env\n- sed -ri "s/.*database.default.database.*/database.default.database = ${DATABASE}/g" .env\n- sed -ri "s/.*database.default.username.*/database.default.username = ${USERNAME}/g" .env\n- sed -ri "s/.*database.default.password.*/database.default.password = ${PASSWORD}/g" .env\n- sed -ri "s/.*app.baseURL.*/app.baseURL = https:\\/\\/${DOMAIN}/g" .env\n- composer install --no-dev --no-progress --optimize-autoloader\n')),(0,i.kt)("p",null,"This set up a fresh CodeIgniter 4 project and creates a MySQL database.")),(0,i.kt)(o.Z,{value:"laravel",label:"Laravel",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'source: clear\nroot: public_html/public\nfeatures:\n- mysql\nnginx:\n  fastcgi: on\n  locations:\n  - match: /\n    try_files: $uri $uri/ /index.php$is_args$args\ncommands:\n- composer create-project laravel/laravel .\n- mv .env.example .env\n- sed -i "s/DB_HOST=127.0.0.1/DB_HOST=localhost/g" .env\n- sed -ri "s/DB_DATABASE=.*/DB_DATABASE=${DATABASE}/g" .env\n- sed -ri "s/DB_USERNAME=.*/DB_USERNAME=${USERNAME}/g" .env\n- sed -ri "s/DB_PASSWORD=.*/DB_PASSWORD=${PASSWORD}/g" .env\n- sed -ri "s/APP_URL=.*/APP_URL=https:\\/\\/${DOMAIN}/g" .env\n- composer install --no-dev --no-progress --optimize-autoloader\n- php artisan migrate:fresh\n- php artisan key:generate\n- php artisan storage:link\n')),(0,i.kt)("p",null,"This set up a fresh Laravel project and creates a MySQL database."))),(0,i.kt)("p",null,"Let's extract those recipes meaning individually."),(0,i.kt)("h2",{id:"nginx-setup"},"NginX Setup"),(0,i.kt)("h3",{id:"fastcgi-on"},"FastCGI on"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"nginx:\n  fastcgi: on\n")),(0,i.kt)("p",null,"This configuration enables FastCGI (PHP Processing) on Nginx.\nWithout this, NginX will serve PHP files as static files."),(0,i.kt)("p",null,"If you have multiple directory setup, it's important to write ",(0,i.kt)("inlineCode",{parentName:"p"},"fastcgi: on"),"\nwhere the directory should also serve PHP files, for example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"nginx:\n  locations:\n  - match: /admin/\n    root: public_app/public\n    fastcgi: on\n  fastcgi: on\n")),(0,i.kt)("p",null,"If you curious, the ",(0,i.kt)("inlineCode",{parentName:"p"},"fastcgi: on")," internally represents as this in NginX configuration:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-conf"},"location ~ \\.php$ {\n    fastcgi_pass   unix:/path/to/socket/file.sock;\n}\n")),(0,i.kt)("h3",{id:"rewrite-root-directory"},"Rewrite root directory"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"root: public_html/public\n")),(0,i.kt)("p",null,"The default root directory is ",(0,i.kt)("inlineCode",{parentName:"p"},"public_html"),", where app files are extracted from recipes.\nSome modern frameworks like Laravel and CodeIgniter put static files inside ",(0,i.kt)("inlineCode",{parentName:"p"},"public")," folder\nto avoid leaking bare ",(0,i.kt)("inlineCode",{parentName:"p"},"*.php")," files be accessed maliciously and creates RCE attack."),(0,i.kt)("p",null,"So when your app requires this behavior, you need to change the root folder to ",(0,i.kt)("inlineCode",{parentName:"p"},"public_html/public"),"."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Not to be confused with ",(0,i.kt)("inlineCode",{parentName:"p"},"root:")," inside ",(0,i.kt)("inlineCode",{parentName:"p"},"nginx:"),", this setting is placed outside of ",(0,i.kt)("inlineCode",{parentName:"p"},"nginx:"),"\nbecause it will also tell Virtualmin to use this folder as e.g. SSL verification requests.")),(0,i.kt)("h3",{id:"reroute-indexphp"},"Reroute index.php"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"nginx:\n  locations:\n  - match: /\n    try_files: $uri $uri/ /index.php$is_args$args\n  fastcgi: on\n")),(0,i.kt)("p",null,"If you use frameworks, they also likes to handle custom routes. The ",(0,i.kt)("inlineCode",{parentName:"p"},"try_files:")," configuration\nhere is to instruct Nginx to try to serve the root ",(0,i.kt)("inlineCode",{parentName:"p"},"/index.php")," file in case no static files found\nin the given request URL. "),(0,i.kt)("h3",{id:"multiple-website-in-a-domain"},"Multiple website in a domain"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"root: public_html\nnginx:\n  locations:\n  - match: ~ ^/(app|auth|api|web)/\n    root: public_app/public\n    fastcgi: on\n    try_files: $uri $uri/ /index.php$is_args$args\n  - match: /uploads/\n    alias: public_app/storage/app/public/\n  - match: /\n    try_files: $uri $uri/ /index.php$is_args$args\n  fastcgi: on\n")),(0,i.kt)("p",null,"The example setup above is a typical setup for combining a WordPress (the landing page) in ",(0,i.kt)("inlineCode",{parentName:"p"},"~/public_html"),"\nand a Laravel app in ",(0,i.kt)("inlineCode",{parentName:"p"},"~/public_app"),". Let's see what happens when we do requests from browser:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"/"),": Resolves to ",(0,i.kt)("inlineCode",{parentName:"li"},"/public_html/index.php")," and loads the landing page at ",(0,i.kt)("inlineCode",{parentName:"li"},"/"),"."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"/about"),": Resolves to ",(0,i.kt)("inlineCode",{parentName:"li"},"/public_html/index.php")," and loads the landing page at ",(0,i.kt)("inlineCode",{parentName:"li"},"/about"),"."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"/api/oauth"),": Resolves to ",(0,i.kt)("inlineCode",{parentName:"li"},"/public_app/index.php")," and loads the Laravel app at ",(0,i.kt)("inlineCode",{parentName:"li"},"/api/oauth"),"."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"/web/login"),": Resolves to ",(0,i.kt)("inlineCode",{parentName:"li"},"/public_app/index.php")," and loads the Laravel app at ",(0,i.kt)("inlineCode",{parentName:"li"},"/web/login"),"."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"/uploads/image.png"),": Resolves to ",(0,i.kt)("inlineCode",{parentName:"li"},"/public_app/storage/app/public/image.png")," and loads the image (if exist).")),(0,i.kt)("p",null,"Let's see another approach to combine multiple websites in a domain."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'root: public_html\nnginx:\n  locations:\n  - match: /app/\n    alias: public_app/public\n    fastcgi: on\n    try_files: $uri $uri/ @app\n  - match: "@app"\n    /app/(.*)$ /app/index.php last\n  - match: /uploads/\n    alias: public_app/storage/app/public/\n  - match: /\n    try_files: $uri $uri/ /index.php$is_args$args\n  fastcgi: on\n')),(0,i.kt)("p",null,"The example above puts the whole laravel app inside ",(0,i.kt)("inlineCode",{parentName:"p"},"/app/")," subfolder. Let's see how it works:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"/"),": Resolves to ",(0,i.kt)("inlineCode",{parentName:"li"},"/public_html/index.php")," and loads the landing page at ",(0,i.kt)("inlineCode",{parentName:"li"},"/"),"."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"/about"),": Resolves to ",(0,i.kt)("inlineCode",{parentName:"li"},"/public_html/index.php")," and loads the landing page at ",(0,i.kt)("inlineCode",{parentName:"li"},"/about"),"."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"/app/api/oauth"),": Resolves to ",(0,i.kt)("inlineCode",{parentName:"li"},"/public_app/index.php")," and loads the Laravel app at ",(0,i.kt)("inlineCode",{parentName:"li"},"/api/oauth"),"."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"/app/web/login"),": Resolves to ",(0,i.kt)("inlineCode",{parentName:"li"},"/public_app/index.php")," and loads the Laravel app at ",(0,i.kt)("inlineCode",{parentName:"li"},"/web/login"),"."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"/web/login"),": Resolves to ",(0,i.kt)("inlineCode",{parentName:"li"},"/public_html/index.php")," and loads the landing page at ",(0,i.kt)("inlineCode",{parentName:"li"},"/web/login")," (404 error)."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"/uploads/image.png"),": Resolves to ",(0,i.kt)("inlineCode",{parentName:"li"},"/public_app/storage/app/public/image.png")," and loads the image (if exist).")),(0,i.kt)("p",null,"You can read more about putting Laravel in subfolder using NginX in this ",(0,i.kt)("a",{parentName:"p",href:"https://stackoverflow.com/a/62965174/3908409"},"StackOverflow answer"),"."),(0,i.kt)("h2",{id:"php-environment-setup"},"PHP environment setup"),(0,i.kt)("p",null,"The default PHP version is ",(0,i.kt)("inlineCode",{parentName:"p"},"7.4"),", which is the default provided from the OS."),(0,i.kt)("p",null,"To change PHP version used in PHP-FPM to the latest one, put this in runner:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},"features:\n- php latest\n")),(0,i.kt)("p",null,"You can also use a fixed PHP version: ",(0,i.kt)("inlineCode",{parentName:"p"},"php 5.6"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"php 7.4"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"php 8.0"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"php 8.1"),"."),(0,i.kt)("p",null,"Unfortunately you can't use custom PHP version other than provided because it's tied to system daemon.\nWe always update the list to the latest supported version or latest major version starting from PHP 5."),(0,i.kt)("p",null,"Support for PHP extensions is varies but you can request a ticket to be included, provided the extension\nis provided officially by PHP."),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"(Coming soon)")," when PHP version is fixed, it's also changing the ",(0,i.kt)("inlineCode",{parentName:"p"},"php")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"composer")," version it used.\nThis is done using PATH manipulation. Alternatively, you can call the alternative ",(0,i.kt)("inlineCode",{parentName:"p"},"php")," version using\n",(0,i.kt)("inlineCode",{parentName:"p"},"php81"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"php80"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"php56"),", etc."),(0,i.kt)("h2",{id:"composer-install"},"Composer install"),(0,i.kt)("p",null,"Composer is installed automatically. The good recommendation to install packages is with:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"composer install --no-dev --no-progress --optimize-autoloader\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"--no-dev")," to skip development packages (things like PHPUnit), to save space."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"--no-progress")," to skip the progress bar, because it's problematic when used inside runner."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"--optimize-autoloader")," to speed up the package resolution in production.")),(0,i.kt)("h3",{id:"clearing-composer-cache"},"Clearing composer cache"),(0,i.kt)("p",null,"If your development is stable enough, you can clear the cache to save space by calling:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"composer clear-cache\n")),(0,i.kt)("p",null,"The composer cache locates in ",(0,i.kt)("inlineCode",{parentName:"p"},"~/.composer/cache/"),"."),(0,i.kt)("h2",{id:"php-ini-configuration"},"PHP INI configuration"),(0,i.kt)("p",null,"The PHP INI configuration is useful to tweak the PHP behavior such at upload size limits.\nWhile you can't directly change the PHP INI located in system files, you can create ",(0,i.kt)("inlineCode",{parentName:"p"},".user.ini"),"\ninto PHP root folder (typically ",(0,i.kt)("inlineCode",{parentName:"p"},"~/public_html/.user.ini"),") and tweak the config there."),(0,i.kt)("p",null,"An example of PHP INI configuration is:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ini",metastring:'title="~/public_html/.user.ini"',title:'"~/public_html/.user.ini"'},"upload_max_filesize = 32M\npost_max_size = 32M\n")),(0,i.kt)("p",null,"See the list of available PHP INI configuration ",(0,i.kt)("a",{parentName:"p",href:"https://www.php.net/manual/en/ini.list.php"},"in official PHP documentation"),".\nTo see default values or if your change has been in effect, use ",(0,i.kt)("inlineCode",{parentName:"p"},"phpinfo()"),"."),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"PHP INI doesn't work? You may need to wait until the PHP process is restarted, which typically about 5 minutes without traffic or after about 500 requests.\nNote that you can't change configs with ",(0,i.kt)("inlineCode",{parentName:"p"},"PHP_INI_SYSTEM")," level because it's only changeable in the main system INI files.")),(0,i.kt)("h2",{id:"php-error-logging"},"PHP Error Logging"),(0,i.kt)("p",null,"The error logs can be seen in ",(0,i.kt)("inlineCode",{parentName:"p"},"Nginx Error Logs")," in Virtualmin web UI.\nYou won't see error details in your website because we use production default settings."),(0,i.kt)("p",null,"If you want to see the error details in website (not recommended!), change this setting in ",(0,i.kt)("inlineCode",{parentName:"p"},".user.ini"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ini",metastring:'title="~/public_html/.user.ini"',title:'"~/public_html/.user.ini"'},"display_errors = 1\n")),(0,i.kt)("h2",{id:"restarting-php"},"Restarting PHP"),(0,i.kt)("p",null,"PHP doesn't need restart. Changing PHP files instantly changes the running server code."),(0,i.kt)("p",null,"The PHP-FPM instance itself is running as ",(0,i.kt)("inlineCode",{parentName:"p"},"ondemand")," and goes inactive after 5 minutes of no traffic."))}m.isMDXComponent=!0}}]);